function [Y,Xf,Af] = ANN_60_50n1(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 02-May-2020 23:24:50.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-166881;627;-105928;629];
x1_step1.gain = [6.4553820133691e-06;0.000655522779416585;8.43401437999452e-06;0.000655737704918033];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.82319043922944812319;7.555877092279132512;-6.0284081326583685012;-16.684274192746386234;-32.809625353743584242;-13.477611844639746153;-8.437292321026914621;-8.1782377974783297958;-2.3419346948642916217;13.992199434240493616;1.9008707508122555385;13.045588673422715331;-14.843393630082468704;4.2803397959349753776;-10.161713780106724769;-1.9245122204089748497;-10.344496891588359944;-0.83232948778539428414;7.7457960141698301015;-1.2644528726066621704;-3.3303678205501889842;-4.4704744910908527089;-5.3916064493401627544;3.1090276437419661626;2.8811567693222954745;0.24691386293056716283;0.22236375552485132534;-8.5214840188119875819;-7.1385023047902631532;7.6011753038500922131;0.95413759396239294919;-30.160411754257033579;-28.225707180010751074;-9.3195896181785169432;5.2443779897370896848;-20.928835337075256007;6.1382100444289289243;1.8820765530978422753;-40.689304853806731899;-9.9241211119286507625;5.5803212329560336613;20.085848594587528027;-15.708923386445682979;0.5156453752584776451;-13.932874942616022551;-1.4828955434627639764;-0.37799927942764105504;-23.889990912528894285;-25.240520112075252257;7.0676306292249950758];
IW1_1 = [-1.5603857454859959564 0.69388930016099270581 -0.44078818711649431217 0.0078879039327501409423;-7.3950989842845507027 2.582373860141928823 5.61885904296575589 -3.9017094605009869923;3.5819034244421845692 -4.6978774875722217885 0.89331800302754527099 -3.1301031826468368457;11.42288361471146807 -8.2494345933717116992 0.94729343472004490234 -2.9346798030824849945;42.750276872429651576 -4.8880196004832150436 1.6414440716406006882 19.29577208125344967;1.6901003582368891998 8.5067536552453812959 -4.3827222234841514137 5.8055295352414484356;15.216817881378959854 1.2567952640117816543 17.96923393914337197 -4.0048992817059323457;-0.24513760445356963524 -4.5023104609011728172 -25.070793953593479841 7.7978345537795110687;0.15731093049127095607 0.82659540545795440192 -7.1949920828723685773 0.67449844462573416148;-13.415674251608550094 5.8730383230914560144 -1.050397593362055737 0.13965454575367847179;-1.1001322454834225884 -5.2386291000970466314 -10.640297903572864868 1.4459658463788926941;-26.464590119124295597 0.43242647620399166097 -1.9737740179031209031 -7.1828399144194348125;12.726883841304282186 15.660162263120222192 -0.79359854504380467066 14.982980391652803931;-0.72362873841487096449 -7.1852217472346291416 -0.33040264837592420166 -2.6561363935651463031;-9.1264616142740049298 -20.841030354408591307 -0.51653679364218196834 -14.113319349303370842;1.1071483582533858669 2.3172822363645440014 0.046421473251959048667 1.4760751560929441517;65.039494874352683951 -6.1026968835676838054 3.971560603248141863 8.5592596430036742561;1.8033837198086219988 -0.76381142109816613228 0.4913261633915829707 0.05032600371359337299;2.7714245035073066248 -19.301569089885621366 -0.17616143844675202779 -20.54015719064420864;0.23688330199359486361 1.6206248243776708584 0.20006840616728530091 0.96141704161512564486;8.1024494879616337784 18.785915353144694961 4.236077609125485921 20.41685602272645994;10.700960273677283752 -1.0290523699379519051 -10.740351357247325481 2.817099382256113671;-7.428619852055734718 5.8411828828024940918 -18.964844297016291819 -13.098869513768203632;-0.15070369316624626643 -0.97009722608985893277 9.2829809466458907963 -1.376340864970426292;27.438599858495720696 -0.93403398111020108363 -0.87647469513897457993 -0.54838465445224116035;0.84832043058175421457 0.29741667425619949805 0.34898761069705291904 0.99644185799078843768;0.66334292729737365235 -1.5873598687616290448 -3.1278453077878483057 0.9699037409025514922;-14.789915018828491355 8.2198167837049389561 6.1799243550341413922 16.68129942934180221;-9.4807616498570936869 -1.3092647505472314595 3.9728310786683747047 3.1907980533810649248;3.0417033708129275205 -19.20796233800236763 -0.53166710999136013172 -19.911014677783008153;0.16346131828824536636 -0.55629233504918496056 3.6890756800377091373 -0.181657157016378773;-40.126944228230371436 13.570758111979504434 9.1938005268606453058 0.65164814246903057793;-45.756572792473548361 -42.519253249054671073 -2.6169850796246416635 3.7458327482309816681;-9.2783793302597068475 -5.8329059140963792629 -0.48164864127690359963 -7.0193063715704546723;7.9613419030316086022 1.1825840976116652747 0.12106020642199878667 -0.42524560033275632387;-0.55248085511754052579 -15.32841046321705214 1.6004136122843815038 -18.003562159499711726;15.550736968591422738 13.804903163604812733 2.926045178418339443 3.5125114403918513695;6.0964802454967497169 0.19879039648923124695 0.98875435860115223896 -4.4795012750696496795;-60.231717380823589281 -3.8939271731340969751 3.3764391830443707399 -56.971773291620174007;-9.7533175768963999985 -6.0154921569311863294 -0.4082487484378134468 -7.7132847659223555681;5.2706911704221441894 -8.0384691080689680831 2.2700924756805918037 7.6300274254467730373;38.511959374820868618 -9.428566856364327009 -5.8164886612260122689 -2.8002620505473498902;1.9837816792362701346 9.6634752352832737898 -5.4969702469675940648 6.9735105525088085798;0.52655253078017383306 0.59081435450066632775 0.11819914167194164878 0.74590618989841417363;-22.952852296359100848 4.8170765146761933551 3.153244291690355805 -0.14341172819081487999;0.55039242919375075402 1.8304887067818105262 0.11352232756409597059 1.1316192017259982805;-1.1289992910406505544 1.9738414478302972466 3.3809730171873058069 -1.606169245066346507;-30.960324429785128331 -4.9291341403494026707 5.9650157061987609808 7.0985484100733673429;-25.450114342244919641 0.8240875809728346324 3.3585981417694728002 -8.1835480035618211048;9.3751153998352307894 0.98760769720099905733 -4.0660563644457790033 -2.9319555468234512752];

% Layer 2
b2 = [-0.091696093112771534517;-0.3026076471877328089;-0.63420293129955584988];
LW2_1 = [0.81363477139139317451 0.023021372771793374018 0.039096640771320884111 -0.35717248030887582821 -0.15520391353245904797 -0.36820947239117352012 0.0035373235997837571519 -0.00093047816427818631421 -0.044340936629359083143 -0.53146552573335104075 0.010376316001894776014 0.15063028820872786939 -0.093782784997075360756 0.00016529736249887224146 0.013572761084827265898 1.2339512223672315372 -0.17993038648013592873 0.72761072957621875101 -0.11672952204334688386 1.8677551977531794414 -0.027690262983157458432 -0.0088123380371777550873 0.0065821494984663895048 -0.029954086395310337843 -0.16212378825198484056 0.19153488709042593152 0.067505065110057799194 0.0039172336538227520153 -0.11061236263728205231 0.11848019098520214121 -0.051499541599165324368 0.11849102657861171339 0.02922050765085079313 -0.16717763719027012304 -0.032040881825961264884 -0.015704227325867566728 -0.0015575432993886122006 0.024652993944495084355 -0.004343646184379554645 0.13488978641198648423 0.017420555212648323323 -0.1454974928552585367 0.33238901303422663247 -0.14107808659013712504 -0.014339814742528048802 -2.9572723788122372568 0.07400431937281365391 -0.031098581744597741244 -0.14573893670314605475 -0.14581188696434110863;2.3054308117744346518 0.043228797166301208277 0.098399777386076761609 -0.43064379386193030186 -0.16930914054519941025 0.46064359654432041058 -0.0016736273092985206202 -0.0030189703126139600525 0.012415133844702894508 -0.61545624845505519929 0.020089552096498378836 0.12426842579899674557 0.14122437581981711618 0.063474361909991658393 -0.10927309681272193154 -2.6292027257314534161 -0.029453173732747053165 1.8290393842390075818 -0.15594579533379301917 -4.0144460023656716174 0.070664764267528962227 -0.0024685539470721963411 0.011101790411951837495 0.02655719403304147852 0.014405883433581585101 -0.047195756801426735905 -0.10755329133572985589 0.035770012499664306793 -0.70992071396908695835 0.14097918861346248054 0.026454806194092791299 -0.13524614202925641648 -0.095684226010233880411 0.43701741065143046017 0.06129713668458709741 -0.16782198584486568427 0.0078150226293646745529 0.00067281591372094808057 0.0011213988326999378784 -0.38360134745661766953 -0.039075810365066278307 0.051970798712466598213 -0.30029406503193661893 0.36468273348061458483 0.030777946566466478362 6.8908000580882822206 -0.051941421174660828974 0.033231743586289275161 0.025729379303653585054 -0.7278211375529669569;-1.1290839074925278496 0.15408718201278057136 -0.22004033435915282269 0.34861434420072490159 0.00064185465848613462193 7.5218444749956221429 -0.060007640228095349144 0.26078710776659524972 -2.1915168793722696883 0.12125709705262155413 0.09199715366648546222 0.093933992652574779814 0.13328680223185770948 -0.46935996986627703809 0.32639618874083126121 -2.4849351875765943731 -0.11653085139509179735 -0.19714237037857029744 2.6035328357414102562 -5.3227964475836033742 -0.035286718932917682245 -0.096476216485927815403 -0.052661662402857668808 -1.2069513687392365853 0.02159216507519269232 -2.9198636845652612415 1.3214284176279755822 0.13529268107187972237 -5.5924938080558606046 -2.6408389774307789999 -1.3973349576027149777 0.16944187752663120161 -1.0103739127676525378 5.8601688073910747079 -0.33232075109564968018 0.43000773155195287645 -0.24515916489198588679 0.29348979972420619067 0.7709635816309318157 -5.2868347931454842126 0.93442717295729604832 -0.046628868604837211964 -7.0797748540738014711 5.4124307302372365314 -0.15274611437660864932 6.5264612302135773803 1.0181328485972382936 0.10075893118798120995 0.34588673143613568595 -5.3147139884608707305];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.533787165877804;0.788527964418997;2.25106301047751];
y1_step1.xoffset = [-1.82517310309568;0.576613863304083;-0.470200245018933];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
