function [Y,Xf,Af] = ANN_full_50n(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 13-May-2020 01:15:58.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-179998;622;-179972;540];
x1_step1.gain = [5.55560185223766e-06;0.000654450261780105;5.55739258254812e-06;0.000637145587766805];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.308925230863426048;3.6265259019106554916;-2.5593622301881540082;-12.650219714432763496;-2.6694300006735218744;4.6092235668490300071;-2.2024630650800722798;-1.9569796820881162347;1.4179564926641690104;-13.503141009275624995;0.49462155707758387324;3.9610146425647907442;-14.681351081680251269;-5.2853162060804033118;-3.9160179235259011676;-2.1898876585766995362;1.9544374612659514145;-2.9516574909280244299;-11.140446693118859045;-12.520753549212617628;-1.1792535633386562743;-2.3254369978080355885;1.2173952885247893985;0.90326149352314888397;5.8717561130857172103;-0.92787657144179791491;-1.0372370385451403774;1.7066260591408533021;-1.3438342602771948808;-1.2797802429004081493;2.6722060571261554429;1.0428909564813637623;-6.3448352514389707579;1.1482912891672534261;-1.0248303999194967595;-3.6461047553572654145;-3.5413211998212301701;19.680140943886716087;11.436406223585377617;-4.1486566355629452829;-2.742681530118829869;-2.818178824274163663;13.625572826863173503;4.2918246369832679932;6.2448039278462079693;-33.53679642872251776;19.903440843642631108;1.2567998494091772166;-16.899719848228389907;-6.2988636070130024081];
IW1_1 = [-3.8658281096536777355 1.9979721049919847431 0.51103987386224569711 -4.0338303997063862383;-0.71773698600685853499 1.172785119896281758 -0.24438087748107842345 4.6185484960552418698;-1.2650568173618508272 -3.247119839656508411 2.7613396439269886073 2.5745949936811789449;11.025126007099744996 -0.58914252140720890782 4.9341343476099455145 2.0636580904588619489;-1.2425671222796252913 -3.1770609087774914769 2.8929682687853595091 2.3690843349075256796;-1.6668077022640348517 1.5374654625166011002 -0.39651756502694773809 5.7764332029383025358;2.5817644038558542618 -1.3675576587623765601 -2.063816364784555546 -1.1502162106527373808;2.4935520867405407408 -0.2321183751108920057 -1.9393873557028815657 -2.0730320422847698936;1.3505472477369047102 -0.91965486025461229413 3.2579954442069141152 0.099627780466112703106;14.266974791097574382 27.955956250609638403 -2.7712552778722252533 -27.727251047863170186;-0.32130456079535929526 0.1187321625142793019 1.7070588870068055254 -0.066049070279582525189;-1.1918448132674808182 1.2741512153527079221 -0.29964519829083896552 5.0587416919717238528;13.079014124727814661 16.713365983555739547 7.0449089440119987415 -12.71147346034364034;7.410635073439509668 -1.743205644310631186 -3.9345584544784002468 0.87322575502181154494;15.87913807271201172 -5.9660727493585419268 -0.22793369304900257255 -13.254950641184766624;3.7183054452459249895 -1.531819663353755745 -0.48118336094878505493 3.4815592604734075799;-5.9307332024569410223 -25.290064684407024487 0.48584984656273882964 21.198036358975027582;-3.0082118614758863728 -5.2091713202289247064 -0.74109083004180276166 18.333697678749881987;30.270569060917495108 -25.878284127018375216 28.119662630293944972 -8.0356402418462504755;13.209472863405229859 26.923780520725056675 -2.5661256092664594952 -26.720508122061382039;8.8344566913473503433 1.0558215759383917653 10.748688787619078866 -19.387285029990142249;3.8466096186970677451 -4.3349253650431229801 -3.4575512621602539909 -3.9546213308266451314;0.069209721153632469681 -18.830918987723883617 -4.6163984628159679957 20.372118588898523228;1.4363878288025084817 -0.1878193326512964112 -0.10128518714151719948 5.8186470602062012603;-8.502878001182320844 1.1347039884035439172 4.308127166992440138 -0.37381812641609546422;4.7707199522056518148 -7.263127534578326383 0.70856594162349184618 2.8738942455356539796;-6.3316790380098568747 13.057456145345403442 0.72427982190042405897 -11.997649723604629557;-2.8345853540120127256 3.8610382262723259572 -5.627993264628120329 0.36425826975552777487;-1.2130955317984961628 4.7138906101774677992 -3.1455577799350402657 -7.0814922427213184974;-2.5742859690930783856 5.1447767524534082639 -1.1120251239889855643 -2.6640983433755329735;2.7968880679230827546 16.465422674639373923 0.057431230429852833663 -27.340726477508894732;1.5204714740793776606 -0.98993027187910187514 2.3808487402498488272 0.38996340029388659731;-8.3534119993001603177 13.221959853873752166 -0.56829159254861771888 16.582738559316993587;1.558927205958041684 0.94706408388752394423 -0.039933411026620901918 0.29295485166115531328;-0.83904634682068313101 -0.260129033000816412 -0.017976683656189807597 -1.8244203967783105824;-1.28667755635030856 2.5291206006222810565 8.3988754122458715301 -1.9558113813257418379;-2.5329206432054083287 -16.738162230625299287 6.9356846492353181333 16.89007872907039598;24.4292048350048141 12.091674361332243492 -20.829024504231700377 0.28635632000551985987;16.238316117041780018 11.062247271196220311 -0.49192481974939228362 -1.1632847066665850111;-3.9620790548244744222 -0.80932388659209852921 -1.1234495382176410416 9.0174218666700802771;0.0122486138907144642 -0.16260448041802877395 -4.5369210306073464167 -2.7775577439968470728;-0.81466672662367878299 -0.24991358098223423467 -6.4563511542231282192 1.4568327604582300694;5.0834666389452651813 19.152459691387704765 -24.688582297636358476 -5.3860539289978621724;4.198825283171322198 1.3664995064372096323 -2.380995903132534508 -3.3924835606881553751;6.3678624446027045636 10.074281462376356799 -6.2834830837591031383 -7.2130879976907475992;-13.701196430787831559 -38.768435928821659786 -8.634757079753445197 17.279635974519678143;3.6971572351937793677 62.299786118219259379 -32.465049965965633305 -70.530633485535474847;1.4604514409502136196 -0.87226142222621050326 2.8090185929819249111 0.16862894249893997656;-9.1534312909066475328 -15.836290634473519034 19.122563421915543813 13.843967753800031417;-4.2245491502667640304 -3.3478862607391843831 0.035881497915011703603 -7.643984273155944642];

% Layer 2
b2 = [0.66548381421570068639;-1.0168500090182974738;-0.024707408401115359825];
LW2_1 = [-2.0414857040793910059 -3.6542421489500287457 -30.410667368314417303 1.6773847035730204968 28.236650005028408827 -4.4660843530334233265 -4.4460545581183676944 4.6816734855869199805 -12.300165131866243939 -10.843805280765494103 0.85968076484148103766 8.4461289037246363165 -0.61025232125369066605 2.8794748544168236037 -0.09713805997782146151 -2.5605665548447138491 0.092307044376465585689 -0.059270443304334834156 0.031551397850390058841 11.343720780489135791 -0.16588650531784751574 -0.31440383128140764191 -0.072900268080465374654 -0.35661972929052521142 2.4052870236192744891 0.51502950863985630381 0.12783445477935476142 0.017141576052269558855 -0.57290415962030394326 -0.84791571930285802861 -0.0019947027393600802112 -11.999784693542673963 0.46196847772408849986 -1.4500963209213215688 -0.056328618095783808406 -0.77861336273297865329 0.34501757334702864988 0.35775380657932409623 0.010173454350091109058 0.40547336854246823767 0.56402340504271764043 -0.30457456037822616679 0.061882483409651294071 -0.7437359153581294402 -0.4953857716867650085 -0.3857607532113044857 -0.33152838391989053468 23.59112395825672337 0.6638475787732873723 -0.33331904755359215153;9.7349666308971460893 11.967599681697391745 -14.354597673272525782 0.36323621665144822934 13.916943143046884401 9.7118560920495156097 2.0823739459565939747 -2.3010479060786526162 -4.254583426491390874 2.39477980099411214 -0.14990981112587897783 -20.813976864700890701 -0.16726755630154557797 -1.8382212631578704887 -0.35532634093247683627 9.9403084632914033847 0.064470482376740592678 -1.0386764908160401877 0.1552100806732581717 -2.529806008705516529 -0.16557834246438823955 -0.082165094605236924097 0.3378211271101765889 1.6026532673836162424 -1.5542998354520956017 0.31888885096634933536 0.40177555113829499511 0.20160169022166646302 -0.60930897648118187426 -0.5635902956389400309 -0.53542493814084723969 -3.2626317907018087539 0.50826492881958107439 2.4602576800756317255 5.8822230462284990082 -0.22727455112995514908 -0.20901423384636758085 -0.0056121043852443179209 -0.31052309442442593834 0.40260946220957055663 0.29075961712844805573 -0.49915747796838477734 -0.14467304799918939695 -0.49266063297215684225 -0.16293552251675080811 -0.24010622030791281545 0.1027059803292503376 7.4096996559217700451 0.022592141128320464977 -0.93156127948269429329;-5.2219924256462935119 -0.094037780144021101969 8.4530557122556970739 0.30927909204113257502 -8.8323320808541332383 -1.8751158393571125682 2.2451499333132884928 -2.7847102902710796357 -5.685754402363174087 -0.62214659769309199611 -2.8649614931954436869 1.826617890039802683 -0.12211955725996953559 -1.8859469697502999619 0.015200264390048449925 -5.2253394066738625412 -0.1568310532017092862 -0.58483795517714631806 -0.070879600723280034025 0.73641274226036079753 0.21242706060199270657 0.30758294372447558818 -0.18800418889433639924 0.11630928159706988012 -1.6850098104614243955 -0.21020569917718784358 0.018508938279523785148 -0.1427637987336606018 -0.51985464858565122448 -0.071159783846174232136 -0.10396945508148382198 -5.4915452905125672345 0.33995157044509255462 0.43740423860196819827 0.75461689440941770446 -0.062467373249196239682 -0.33325232160408102544 -0.063965429832776102281 0.099723964197837730583 -0.041499917097601105032 -0.35958930532321359275 -1.8251890874553740041 -0.096282381493130272943 0.16189304775342586162 -0.39719955331805684162 -0.62820064716968149199 -0.67861201952603444898 9.5400794690800267972 0.16623654595147763224 -0.14915596198669139882];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.533787165877804;0.460242512747554;2.25106301047751];
y1_step1.xoffset = [-1.82517310309568;-1.23254956773967;-0.470200245018933];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
