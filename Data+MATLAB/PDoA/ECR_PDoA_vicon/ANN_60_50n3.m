function [Y,Xf,Af] = ANN_60_50n3(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 02-May-2020 23:41:04.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-166881;627;-105928;629];
x1_step1.gain = [6.4553820133691e-06;0.000655522779416585;8.43401437999452e-06;0.000655737704918033];
x1_step1.ymin = -1;

% Layer 1
b1 = [-14.529519729001057371;-11.342218765670128988;-14.484641932311721035;4.4131092285953990029;-10.62548400955353145;6.6630482584038182026;-6.2784944621618912208;-2.1109765436863496824;-9.6685421826431880987;-1.3339496988245909126;-1.8582591403851487222;2.201842243917740749;4.8305058696674141316;2.3918385494306155792;-0.17911369543167482421;-2.1054300839800612621;0.87988814126828618356;-7.2114142495149167189;-0.24831091246899719693;-10.942889957178786986;-1.4566655921156761444;-0.6149313371589276711;-6.090765629908695189;1.603169181298615964;-1.0263611592328074629;-2.9401092566901612102;-1.1478151000491090272;-0.21349107064052402771;-8.4815120855744723372;2.9342490937456502387;-36.798661454882370947;5.3801091427365053121;8.2750146925080034777;-14.898123487579407964;-2.422314971134521322;-1.9443875678792061912;-2.003958314200140034;-9.8675784899968963515;3.1821420221069338652;3.1579362428585393552;16.794881288334668312;9.4587663532156422974;8.0700303915509241648;-16.33631620647912186;-1.7792875120426761004;-6.6144836996305071963;-10.856786838798482719;11.164487398016108344;7.8781288984229620453;-22.209435878173856338];
IW1_1 = [16.352442898563090523 -6.2256796664628311078 -0.13142858711782420822 4.4875053101250692578;-0.72289806471943018895 -6.5282075498457885487 1.1188128424766403679 -5.8311108553240318386;17.216376961007533453 -2.1687253544766393887 0.28508413907072321924 7.9447300220597218967;-0.64365657036070533792 3.5020526496781427817 1.3514325223155354561 4.3051316559934438288;2.7588101142071836946 -4.1160629502175609673 5.1771162498777156813 -6.8766465794800524236;-9.6040571804502654629 1.474871799433624231 -0.32224302242995617185 -4.5727627274882616248;3.7764643605831862416 4.3986211964039618749 0.010016636816590596126 5.546744400675442499;1.2031192245963970855 1.3060282308707249488 0.2691448068631513979 1.9213983925226378879;7.1414940483421140982 -10.155175746098398903 1.4812301613770644249 -3.8554972215617757669;-0.25384015654931940675 -0.1372962399869034622 -2.6000558368190005432 0.13708300119382896276;3.2473575842537503178 -2.3813198779189255205 -0.077668429889586262926 -0.042862446772370423054;-4.0027688944504111745 2.8611562476820089351 0.080600918216003000771 0.0021979523104073122458;-7.1327256217908407976 1.3773017216953269415 0.04592449753018363473 -3.2477494596881104627;-3.3248682001135576591 -0.57039320890814104725 0.21634812173231587895 -1.9877535154809951035;11.858289613003174523 -7.6321869860310336264 -0.13377010416378498636 -11.287403170252220619;2.7653069242238603742 0.61312225149052645978 -0.15119947690375096228 1.7723122168929712483;-1.7492630071573189721 0.9312360293828000346 0.11328805216035857384 -0.17869623003490406332;10.488899995511339114 -1.6209511731566506043 0.33374613153326199155 4.9744740113787671021;-0.41516480355940627023 0.66267358936311482331 -0.035614762359395674141 0.80078960189223313826;67.806130855225873688 -10.638403266765978472 4.2739403497757653128 13.49710510899377347;0.7570325943574114369 2.6033371703171113154 -0.159048890715412089 2.8864169386655929017;-1.8715086389581914172 -0.17436421570201529607 0.20283581666144323563 -1.0720054764673181413;-3.4013860702837539485 -6.2980780298477219148 6.405803074488870763 -10.200462503935042946;-0.95367022298549142256 -2.8068381954894654484 0.15280000930791939884 -3.170925204966009936;4.7573396170981023801 1.8892825316503318867 7.6939877269587979569 -0.58829625898696991104;-31.122805474523698166 -2.6018172685698712776 23.095838460425046179 8.1019395666006452927;-0.27265993953156997254 -0.08061166855364730599 -2.4851738493365638227 0.25687085279204119326;-0.59697365843228356042 0.92762207344483071925 -0.071551022883658763063 1.2016738728317550855;-16.165468709420014903 13.098824548940383394 2.1268617697731349026 13.265730318442413349;-0.231291535106513374 5.1339233529166463654 -19.510148303133611591 -8.815152292913731813;-54.665191081370934967 -9.4261159770153000181 4.0086339933993739848 -46.537027631736620492;2.9005787544990848659 5.5620946582887365039 -5.3550210341905106759 8.7206952289134616052;8.8426829770551691468 -2.5720744640586801211 -1.9071366341246152043 -2.8873998677910752697;-8.3643397709718652067 15.403929889827315591 -0.72229325821364687155 36.258868754584320016;-2.7659517698920210726 -2.4547083037318797594 0.30373630307297222464 -4.0378453094744592988;-2.1886543552858257478 -2.1790018887917543822 0.31467906308601828469 -3.6900858313336075689;-2.3391042464077331786 -2.0952391742003584341 0.28296969808737620911 -3.5346505293023842142;-5.5858405719339936368 12.441909293971733064 2.6865623573180261729 21.167511451120624599;7.0816035044919711794 5.2018814243256290553 3.1096570613509313397 3.4031608093598975096;7.3941963764602061104 5.1766671931995649203 3.1427995367661800685 3.6842677849889584607;22.050384062755277625 -4.5514230767598329308 -4.8535415789126847841 -3.5941277864246781171;1.7782385588631406392 5.8093578462354527048 -0.010159748033362503428 8.5573610197657306031;9.828084844072753512 -2.5757917468800957117 -2.2331666240587222383 -2.0962171193664436153;-20.182096002146565183 16.290776022081395524 7.7322780763793721448 -8.1191597159187711696;-0.57781748003910293754 0.74518291592259544576 -1.0968569970003241298 0.68385865110884647144;0.73290863679595841251 4.7604956622334366756 0.21789746670401788364 5.3211724600160019705;-11.207943506461923278 4.1405025689194863148 2.4877622336412308357 3.5088029863544196729;11.716722814377655837 -2.9885822211282615513 -2.4268338188599964944 -3.5075622457305355439;9.1827931243357099333 -2.383877484202301833 -2.0249317909628854473 -2.6016498384787678511;-15.108025987520770528 -13.729001494229208902 31.26701340104166249 26.740451534392430943];

% Layer 2
b2 = [-0.2822180276250093045;0.026088498564691805365;-2.1011145234543238125];
LW2_1 = [0.14018876968207896749 -0.08779378345649230253 0.19983966385020587864 -0.022402718867115284374 0.019107677001636718533 3.341776678143897783 0.29277988109249092341 -0.1887744241511915555 0.025373773250508976917 -0.31942277872646135384 -1.9828611828672033646 -1.3615263524364744629 0.58363675662597347404 -2.6099908676275100916 -0.12049877937417267926 -3.4247250543237997 -1.1760193940261420842 3.4174533431664473326 1.506847760575556805 -0.14614701148302533529 -2.4391256010518129749 0.71775870598519009302 0.049178400557381665714 -2.5208172678196643091 0.00096213086086137920329 -0.012212550439271859307 0.31743031759921003232 -0.96848527279290796965 0.10491006324488655332 -0.0095555485731432469182 0.020716246752864278524 0.047976414094512198627 3.5973915610119688857 -0.0062430752091349028116 2.1901662862392874409 1.5595979119744114438 -4.0315615170355103558 -0.0030115226577472307967 0.082479368633201211036 -0.086579771995041021615 -0.43161035523375868017 -0.012717795873943268936 2.6861127052784952163 0.050406060519313580781 -0.26625943055033274298 0.082816568315088517904 0.85019001803303628773 -0.85368781530822868131 -4.0319083146316243571 0.033349626845903916628;0.11425699575901761273 0.20943283138413226752 0.19416242378570400251 -0.055065179721840828986 -0.062185586176023571747 4.868592098925422107 -0.16888048110015829728 0.23899522454778682201 0.14040530110150667431 0.32160150281186261623 -2.3341887361208626395 -1.6284338245009697399 0.014569863559884517826 0.020518805827024852451 -0.091309290318471292291 0.088247541969568993325 -0.33212249797506326887 4.4553956133204657419 1.503733329605067004 -0.01601962293897362874 4.4160938503562148227 -0.61786053789430350758 -0.019784041015185025586 4.0472381869752380723 0.0042371378951023257881 0.0084144850398622170196 -0.36098212334424228942 -1.3782009825457575136 0.09702636477090774425 0.016605313678733347321 -0.066786307103001346652 -0.019430420083761942157 -4.9804655300767279869 -0.053939358881532464829 -2.8090315348629522063 -3.3014720411119102828 6.3883235733595817862 0.01255474695950316473 -0.12592067244536064852 0.12989618811942951759 0.46659683417307018516 0.27373552321000721443 -2.8889802181215480381 0.00047196898559061120464 0.079721612097684108056 -0.0090496775820593910317 -1.2309941766482976888 1.2282437084033976937 4.9199634707420525359 -0.025469755447975112039;0.023709154002864579747 0.10710169682842786421 0.18714916722559318818 -0.47303312336531777582 -0.29812246777485612581 1.7147035952652587287 -0.055173292228305435836 1.2103569243517804388 -0.24649078203945995469 -12.104340720854365188 2.0311893339709685691 1.8930861669096703537 0.35829179321690840521 -4.2343632400721666897 -0.11355521881563766795 -5.0483140395421139957 -1.0171467874821880084 1.7005082845242260881 5.3236921753769088639 -0.15319303481460844196 -0.77318956527779514332 0.089597055163341834949 -2.4678142371100548758 -0.47129347342393307363 0.16685917305323386128 -0.084954115408729755088 12.875163499287829438 -3.3039923280548473272 0.10434955253478414572 0.18757887640261000639 0.46827532922773867918 -2.585192247174513458 -17.972592171896465629 -0.49400906678818157225 1.0194220511688776298 2.5543887815874577463 -3.8034689936626007167 0.39112485466468610573 2.1944224254997757306 -2.1581036314755603911 0.2634640226034465349 -0.020766999429339454142 -2.520830542745910563 0.44625606063251749278 -3.4991741556041899841 -0.51200049903758870773 -5.4726743968072657509 4.2363704483491977371 10.387202682011574595 -0.28557933192873746764];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.533787165877804;0.788527964418997;2.25106301047751];
y1_step1.xoffset = [-1.82517310309568;0.576613863304083;-0.470200245018933];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
