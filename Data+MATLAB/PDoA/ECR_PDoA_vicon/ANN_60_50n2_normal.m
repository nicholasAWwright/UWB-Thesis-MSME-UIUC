function [Y,Xf,Af] = ANN_60_50n2_normal(X,~,~)
%ANN_60_50N2_NORMAL neural network simulation function.
%
% Auto-generated by MATLAB, 13-May-2020 22:40:20.
% 
% [Y] = ANN_60_50n2_normal(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 4xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 3xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-166881;627;-105928;629];
x1_step1.gain = [6.4553820133691e-06;0.000655522779416585;8.43401437999452e-06;0.000655737704918033];
x1_step1.ymin = -1;

% Layer 1
b1 = [5.2622567428145625712;-7.413509463489297957;-18.234959305028688448;19.309887031883864239;1.6985913680124165026;2.7247740647795470892;-6.22504228367620982;-13.224370060474932131;-0.99450276935530523836;-15.164839701976893238;15.728127469786874926;6.667733950465701831;-12.213727574547071697;-1.2834397148452048043;0.83225768610050088192;0.90670703135787300564;-0.78060990588078771335;-7.250672261413749986;-5.5675108130065904533;1.3906817365274062315;0.61512069601408103647;-1.5819694082226689602;-0.21522351388992294607;-0.436605786382547989;1.725850922246101371;-0.41276877351862795162;-0.36282369225795990664;0.70995034801026690729;-3.3587702261624543532;-1.2433240004440697657;1.897612278984655898;-0.31163664302007593188;3.8291577029583323544;-3.4925725671611531631;5.3189380331735041096;9.3644630216334885375;-5.9282163784749117852;-4.4863193910774574746;-1.9525360080455160805;-2.991577596739441347;-11.833679088614850627;-2.175801689287367946;32.667088270734886635;10.228680122395395813;-1.0798732924745426676;-31.36084221928272342;4.5723506611798070409;28.025450072181609329;-28.910295827947997793;14.343277373280523435];
IW1_1 = [1.4127951230633726265 2.2566885941835868046 -8.5486345612275158601 -6.5135469570536654871;4.24869970325644708 4.8366342537243101063 1.7698519538627126568 0.98288061584360941758;3.1637588382282681998 -5.5098884741332616599 -0.62143771587125051781 -16.739112563712101434;-11.752472029240195184 6.5248643719571548516 18.167537142174154496 8.5941504307754534864;-0.8187822744148250953 -1.8162607113240263335 -0.23283851248284670454 -1.0992825497770934984;-0.7676003038950151014 -2.1143117193470644111 -4.3189349500257279146 -0.97756682083816315298;4.4726976660585915369 -4.4650359700469772761 -17.881531262682681671 5.4740010235783920223;11.941164139614631523 -15.696600263891530957 13.707199558332163747 0.10110709555704028295;1.0465830726580180876 0.15234398361907042219 -0.20741191828929400609 -0.5704240262788371485;20.175509665940943194 -15.217584591660036963 0.63943955691720233414 1.7395733071175512041;-20.849594284832619451 15.805272425096548616 -0.66980918404311351466 -1.7969023095675524804;-6.3611899253857027148 6.8210441979881544228 18.704005619754276779 -8.1899313201797259154;8.0824342088709943965 12.080210323709145825 20.74858082696169248 0.54739937082538647761;-0.39340012568251231384 -1.4332263610667317355 0.032044867214203097416 -1.2884466878662521605;-3.5052045768300934547 -3.4890629979834555385 -0.34874287282087296225 -4.2293393670686603159;-1.2163066712183348006 -0.35108112249411393968 0.25449305674131800226 0.57297123538817518185;0.72832568510594419831 0.39361458168030188931 -0.033810909849748937983 0.33645520890762337096;6.9693268807417085853 -7.314991320282803855 -20.276403916386641413 8.8393015576816615919;14.387403429571662627 6.0667287899420427877 -6.7747575722643071927 -1.8001740305006284082;-0.49046896425521480101 4.2452940859815075925 1.10768290436038086 3.3331500737521686517;-2.6702611367355002514 -2.7100308688973879789 -0.097699006518300560153 -3.9409419222055226406;0.64596320035992382813 -4.7978699662764876521 -1.2065098167395513773 -3.3760733296954343885;21.963886402646675577 7.2226676245265268861 0.69491608167747653813 9.0481172072948208296;-6.1504811772745568987 -7.945538831348068598 2.3216398247292615586 -20.41805005516458138;-7.372451461048350474 3.043311747970242287 0.33766601227592513146 4.8240038451333573377;2.0617930429995725561 2.1023261495808256427 -0.14824890006092023009 4.0171042627962938454;-5.2337046084747393948 -7.1674149208323605365 2.3008848941609327809 -18.425072519686409578;4.0232978517356903225 -2.811903153693309676 23.1828737498506392 6.074888122733831608;-5.448467087176142698 -0.49909813481615378228 1.3719131021228565537 -0.95438181698559865218;-0.82084592168408099244 1.7303320083500584037 -13.342733817239210481 -2.5106092819388785564;0.24968098129682669839 2.9030157835276337863 -11.875400492332129687 -5.1869032388865505823;-4.6355615951776627526 -6.9172162163605870333 2.5418259201891442167 -18.005328441456729394;4.0512352238821609518 -3.1684914785223265987 -1.0433911490464575778 -5.8579126898503366405;-4.1211903888618950376 2.8124655615415847798 0.99894526704272956774 5.5687888287173530344;5.222002492276854646 0.66458331515464563743 -4.2572302432318842591 7.9655948619166538904;0.44806746919593376521 2.3902822348913734807 29.106644248276371201 -6.4887453000047328189;-5.4596150034967010356 -0.4711450742528692226 4.7785663740817483358 -9.0310210368114383073;-4.3091867218536776818 3.8562535962243633669 1.1000902211514809181 6.5628174201329425586;-0.11176955243655162242 -0.13308490657003824165 -0.33577364773971829504 2.9679031871857519675;1.2718742996582939053 -2.5828476842973802086 13.442382919066950819 3.0174218397205407882;-0.4788945611133652025 -3.1939762808024876328 2.1638750776996031888 20.701829820272397598;-3.8310160818179284092 -1.2735198808718850572 4.4856503451524174508 3.3649989172167114049;-7.3186611516008692746 -40.832523939626135245 19.81934402655412697 -37.873531213666566941;11.255547711182172677 -5.0408938226788944093 -7.1715527368798417385 -1.0514046336477396171;-1.8142586008990935209 -0.055605719371295422859 -0.52506058619963058565 -0.20599928537738423917;-0.17706434440513121875 39.046836559391408628 6.9936119351810352995 38.201238989820815561;4.8783399000078029317 0.78097685672193162265 -3.7589512476920892148 6.7086146926064573748;37.020147487022605048 -1.12371023993926622 -3.7567024902192072133 23.179258075823739205;-38.122088418432632295 1.3347992766961609412 3.9244619237251625599 -24.141989624987342467;15.2846715087480991 -7.0028954093934565606 -1.6273334725167432069 1.7488986137158997192];

% Layer 2
b2 = [-0.25984558264429236107;-1.1860943518775826089;-1.6685644997519393229];
LW2_1 = [-0.080208691206414106656 0.15999010819255593541 -0.077986918462790988382 0.010002079361342789549 -0.48987126894194760185 0.065233643375573815981 -0.024633432963804258869 0.0093691298611422498682 2.2142159825999883083 -1.8466333499780971383 -1.7772659781695732129 0.04561292945235301266 0.01156465013967762287 -0.30605757689451951187 -0.62573023316012277295 1.3811319561760011521 -2.1281713629423024692 0.060792955141424166732 -0.021731770041289458911 0.3082286610265499438 1.1559930533085795989 0.23448733784495084942 -0.021036970275593955965 -0.23156650506315043514 0.075094093223117663882 0.58246609706464591572 0.47282192369203979165 0.0010624818925095869549 0.014291384948308663225 0.023075665211229435397 0.011625705836626207615 -0.27970426172121776176 0.5750707608228385892 0.27719210384605591502 1.3805258664644799449 -0.0080280606845725289294 0.56400261948958463343 0.37210439441904918922 0.033426354190609706973 1.4724077216829430461e-05 -0.028075300103414264213 0.11072555767572507535 -0.020770432083303855264 -0.069548200681824851044 0.12503473014505198102 -0.021249212788541835956 -0.87947549471949704181 -0.13495468297725343731 -0.13875803125339272737 0.15256636982978696859;0.05635144691389690208 0.13177458896534549604 -0.13989090328992229151 0.0098361950020912202602 -0.46739562664452283247 -0.027552228682829416062 -0.0142626427495603815 0.033005503205461812766 -1.0322423291560487435 -3.9950777218656323697 -3.8197809307129459988 -0.15374891470774029734 -0.017783647527893017143 -0.30500362704838818173 0.065142769740090741837 -1.0679696949000985207 -1.561428187205460949 -0.13327843552188223253 0.02079225563522470524 -0.77420583405205567473 -0.053013001490943255367 -0.73126815432454106425 0.0617574871952687246 0.31706653951303243044 0.18334466261256654462 0.28382552376940056726 -0.76481187987398890904 -0.013477013096641291684 -0.058941643087745507201 -0.021029443798141634475 0.011224590931449368592 0.50743633898463069709 6.2735593716498812 3.5300293767070254347 -1.8703422838773919867 0.0072491756188806247621 -0.82285957081376814859 2.8473286064367693271 0.089502841871228616677 -0.012804325599706014097 0.043647109479667559051 -0.094716636586444080681 -0.0032462678196676511902 0.05877783783292375025 -0.53409112725007279465 0.015771710957102093309 1.1218116197912504362 0.093218348088328836787 0.1219153010267874232 -0.14882713744481740337;0.81692054211958220478 -0.67905397137556400278 -0.017828803684510386579 -0.15454664993378045001 1.7168463443916843758 -0.80347576693743205656 -0.41127952418711577476 -0.084362884107929650424 -9.1772308256545631622 -0.57836984009854119915 -0.59823729371347511563 -4.1503345224378023204 -0.12767599186284614432 0.83894257910434455461 -5.9203882743377969078 -8.1165993431163574456 0.31440604015046647035 -3.7439583559968703241 -0.15788456959489691189 -4.2371343551844740105 13.630308328586620448 -4.0527328851302808488 0.14042342933200938071 -11.475010509660920732 0.068658190996451623489 8.3833664607950453274 22.057718846652612399 0.088107920366366554443 -0.76809837680065440324 0.31705238270341751239 0.50235087120784138737 -10.089546998430799718 19.113725262352613044 10.088720800861315396 9.7620009713814024366 -0.1971427879507491876 4.5295612189926917068 9.0028263926841702869 1.3168642483746926253 0.22616079954733084301 -0.15005212624533434407 0.16102390176968775504 -0.11311275155288956495 -0.39692510388700724677 0.20203300477260011103 0.093658205648504633256 -5.3928827214714756266 -7.45111428126730857 -7.1973215785126152255 0.33905903816467602985];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.533787165877804;0.788527964418997;2.25106301047751];
y1_step1.xoffset = [-1.82517310309568;0.576613863304083;-0.470200245018933];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
  X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
  Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
