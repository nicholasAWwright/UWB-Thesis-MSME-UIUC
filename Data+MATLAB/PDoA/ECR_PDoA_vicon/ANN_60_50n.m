function [Y,Xf,Af] = ANN_60_50n(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Auto-generated by MATLAB, 02-May-2020 00:46:50.
%
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
%
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = Qx4 matrix, input #1 at timestep ts.
%
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = Qx3 matrix, output #1 at timestep ts.
%
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-166881;627;-105928;629];
x1_step1.gain = [6.4553820133691e-06;0.000655522779416585;8.43401437999452e-06;0.000655737704918033];
x1_step1.ymin = -1;

% Layer 1
b1 = [2.1254257555715292405;-2.9954938083133533233;13.047754090180875508;-3.5792136542912178498;-7.4773657444864101151;6.7027909744551230631;-17.257730626009625041;-15.678603143452638946;2.1912236162703364606;-2.0478171739536015217;4.8247591620447884964;-2.0226348358127808069;1.5792625782361400244;-3.7976032291674512997;-20.972900623823502286;2.1627695623491831611;3.5524978733372853945;3.465715600620096204;1.330341345660622121;2.1271189756508617208;-1.6487465448372478072;1.6889531372842789825;10.849063211147868202;11.374433202526603282;-1.6445507238686438711;17.718622685128732286;-2.6140306523241543246;-4.428796504489789676;-3.9750766674949438162;-5.863206269126469472;-16.789877103619495813;-0.001298394708585503014;23.832782520994822306;23.910137543341662081;0.024926123419238801343;-2.1199864192779882544;2.2660066777566330032;-1.3820951805580636851;-1.8375880919928919699;-9.578986689935579335;-5.7809870917353141095;1.8882879479976542036;1.4968697583200218926;-14.034826184000209537;5.1832577335148757314;5.6475095542579625274;-31.343921332971049765;5.6807808481407242596;-26.079554248582997644;-47.373230260884348297];
IW1_1 = [-1.2645051742667399175 1.896046782537746056 0.27693210609696178315 0.78787522246438457252;3.7772520493430228328 0.34632896857158979032 0.17296505793096761394 1.6957739385487682338;-2.5354189229255337246 -10.997600620756548651 -0.37737249375709053245 -9.1174708703549072197;5.2524030371435985742 0.71999751676316769977 0.21328709875417131703 2.5063865617641711836;7.4227084422483029513 -1.7063867761408970658 0.095642256762585281527 1.0499059982210423581;-3.8127316289389865389 -5.7703890248456390921 0.011641238402007668407 -4.4390038225584946829;22.557236716681046573 -2.2681546796884393125 0.78546987139703727809 10.086234830839845955;-8.3510110655565554794 -7.4963892122955684272 -9.6070012557935005049 -16.248786706830134818;-2.666837502618861766 -0.49495865655244764003 -0.11830133859198552204 -1.3248751208717466366;2.4147610080607893046 0.73670413793901878829 0.08884743608678023763 1.3113737572319925651;5.0650456751595491767 7.0074816168506544045 -0.62514325784758095761 6.7836750068649935841;3.5103734700075541753 -1.8958608765983375744 -0.53133271133336767988 -1.1829246661863557222;-0.22419268865865865648 -1.1171931019713614575 -6.0151447501920802807 0.37678516469447398407;4.7148180545115687679 0.33686172478744880188 0.21288458684006769661 2.0473999464041794383;24.389680034710966794 3.0027304445861493498 5.2373925375124814607 25.446383718809084229;-3.8041679143722162415 2.0128650361599187413 0.58904339016711459998 1.3365074754589785222;-1.961399861462619576 -5.2451954693680153952 0.11897856097177310353 -3.356707341866888239;-2.0006759053853588881 -5.1519085756239979546 0.1179635728694458513 -3.3122343493179347007;-0.18468419835526694861 -0.89232254462356963565 -5.4513212640990866831 0.16643044928581524067;7.0572837210006333919 -9.4229168046091373867 0.56419219423619371145 -2.9013627241718054073;3.1356064101192440141 8.0428812076541831289 -0.12823482281611719991 21.312667345652346995;-4.4759204692840892648 -8.8336660229038717063 0.34987551744755512884 -23.928469911419746552;-31.414861902802162064 -16.135828810600010286 0.18450082960942817967 -15.894091388136729392;-69.134457592959762451 6.6908826007986466067 -0.25104057863299678033 -10.188463884611120847;3.6572398625979394282 8.1732987364072133829 -0.24919228833120291022 21.819445074284406161;0.89174508591800560886 20.568550019647585003 54.631339590019436514 -27.640044162842780651;-7.7388678676542976831 9.9575414799701107427 0.71801929641222872469 0.56498930527944202229;-42.763359625446526024 3.5197279995311547829 1.829102584446368196 -1.0986423230270121465;-10.310165272733394559 2.6279105840136076644 3.5376461374375001157 -7.4414365155107091709;-16.901442181227938732 -0.69278225539431714797 -11.158515743399153308 26.534609308353992674;-16.253158070822703252 -9.7981455654616649298 44.688395567210669412 11.198430139376286618;-1.7185431816437461983 -1.7879557843494100489 0.28781631634695420408 -0.95693115126076289112;31.244496550419960101 -9.2750553684496779283 -6.478811451814977751 -1.7790070984215680117;48.129461506268064852 -14.013312534478924221 -8.2021775474892049118 1.9395078784277768325;-2.5842209422607087532 -3.4941058702182683504 0.2811124424096633212 -2.2279203174149651012;-1.9015958925563731796 3.7443653532856147059 -3.9909393553460525972 -3.8920732249013378912;-0.17861332243998992442 1.7521312516616085464 -17.891467388802645644 -4.0843426664637219048;-0.7904277282438442187 -0.46715044934144117628 3.8423777209309677438 0.85777823250012530387;-1.6788228687640820436 3.1047193042798748586 -3.4225297792310778178 -3.277092520355374905;-10.326862629412074668 -15.557337498969884493 -19.139512335890021433 19.028462699404911973;-1.1918135043614157542 3.3010598369403361119 0.54455878279481839677 2.9454370057648153747;2.5519867423220095048 0.9042382869524416833 -3.4141546537983065157 -0.58649763796937304239;-0.18571099736442933659 0.090689491644003666915 -11.985428184071919233 -1.56536255257961332;-22.478327000881467512 -14.293164480254278104 1.6817128821113938031 -1.6468429587827584371;4.0028023708252069568 3.7047695441497388025 -4.1988805280123981944 0.23379094532582728183;1.2133501683984133646 -3.2703899078821541124 -0.43873638538936426956 -2.8295030320210261543;-39.292937200626283811 -4.6785768581486459894 4.3713256489995533371 26.745221439497598226;0.6843645430905620497 4.8192638590631196038 0.58391443646360774444 3.756821779815511686;-31.506933496980085607 17.381096413247206556 10.693616331515540807 -3.568685435183535315;-48.961404953223862435 1.2293774548845188832 7.5338628556049878071 -18.786705722791349871];

% Layer 2
b2 = [0.11113033121932965053;0.21428289260522406789;0.89722008818420340148];
LW2_1 = [-0.17968009234891021975 -23.492492242010762027 0.019896926277243542902 2.0978979636127279562 0.33316707389027311326 -0.3556651460631707895 -0.26614919148380511427 -0.012260941990672463361 -20.282864661161255526 -10.73904403048984868 0.0045631497576543930683 -1.4580981857085910658 -0.22487020679208991059 11.563087722382492828 -0.045161990390890312252 -1.3227705211315279321 3.6381779947106664963 -3.793100503201773499 0.29258845818740597533 0.060383746805243145028 0.0010941582133584301217 0.056413665366567909698 0.007195019426003031876 0.18331343086051096747 0.053450919426291737535 0.003190292003538187926 0.050887023118642606134 0.15726229809418032501 0.023996101543713694443 0.0087814981515090019537 0.0063540263166246280235 0.005978287254671151886 -0.15607280496277611825 -0.14642466064223688682 -0.017015867002408962411 -0.15220519153962647207 -0.0032986138509281345312 0.050366475569857294126 0.1885235082042611976 -0.0025328100965289813452 1.5083053296986979053 0.0035687002858551231631 -0.028078836431758291692 -0.0066946444931855917868 0.037068618943003360522 1.7747371030595311403 0.030019629227933414262 0.02240681131816130503 -0.025362110913966083581 -0.11503910321204535716;-0.59992716284956704165 -16.54253543671240223 -0.14229531980149467962 1.3502832069931502978 0.25174349911387589041 -0.033474786021450986251 -0.26388826334274079199 0.02060000587775275005 -14.532262704896169225 -7.3296992694848954741 0.1998999721152192599 -4.9703501899170055012 0.0098435647668952391126 8.2030070535143710941 -0.071122359777160581995 -4.359865291596262793 0.44238031814295675215 -0.74456695793238159009 0.026892381424826496822 0.065362166400043844594 0.010044339445584936354 -0.29836603715367837619 -0.0088181506843872069223 0.025034742157357320336 -0.25412541964234713898 0.00037202151595189377961 0.10416126719664467459 -0.052870958296848083457 -0.00067381578390575077621 0.0072795650263595855153 -0.0073043215798550015921 0.30952153391605946586 0.15411314877872445139 0.061687687195274308605 -0.3572486519519661452 0.14030000716848603504 0.013111594825091589522 0.012599041168904617782 -0.16073159590363395033 -0.0060761829453778804302 1.5902264627928952567 -0.042598053469478140698 0.0024295907622707895931 -0.070917880842799166374 0.0038770504401889217122 1.4207165966832657755 -0.048445453890459531932 0.33295115312144418773 0.028223735278314825842 0.050609021999255668356;0.046927779727830805367 -12.814819366630800346 0.11619261795531195258 0.86732898724249318789 -0.025614603029247232785 -0.021731811707632112812 -0.11714926272953493647 -0.11528066407712370123 -11.277692868624432876 -4.6910631503989366209 -0.3559375156293447251 0.2568976618065204609 -9.0251285291361167396 6.0789303565251184835 -0.032622765407450862729 0.22359799457267121037 -3.6323684191853460312 3.7528700135721573261 11.377342365633795751 0.0042299423167994351994 15.346884034008564157 -19.680811292692727221 0.08332284640142199883 0.10652212131866001243 -35.043241592799979855 -0.12655495506418801277 -0.0070624656217598471425 0.058581800287553859041 0.2127141257715880196 0.047048058105770437787 -0.10341956829048398747 -1.7622870518825892727 0.30463273689521386256 -0.13750743319439293066 0.95883131923137954189 -3.6005066247080148578 1.1358837172734688181 1.4383158191580156515 4.021505342896688262 0.14179990028688921333 5.5080751374171841306 0.91593750335041790311 -2.1413564654598742365 -0.15603236344174339911 -0.47653611308895066356 5.5318292634323560364 -0.043285253672464801822 -0.011177723751360883753 0.487407909026821351 -0.1480732018690593399];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.533787165877804;0.788527964418997;2.25106301047751];
y1_step1.xoffset = [-1.82517310309568;0.576613863304083;-0.470200245018933];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX
    X = {X};
end

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
    Q = size(X{1},1); % samples/series
else
    Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS
    
    % Input 1
    X{1,ts} = X{1,ts}';
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
    Y{1,ts} = Y{1,ts}';
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX
    Y = cell2mat(Y);
end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
y = bsxfun(@minus,x,settings.xoffset);
y = bsxfun(@times,y,settings.gain);
y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
x = bsxfun(@minus,y,settings.ymin);
x = bsxfun(@rdivide,x,settings.gain);
x = bsxfun(@plus,x,settings.xoffset);
end
